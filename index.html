<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mundo Smart TV</title>
<style>
body {
    margin:0;
    font-family: Arial, Helvetica, sans-serif;
    background:#f5f7fa;
    color:#111;
}

header {
    background:#0f172a;
    color:white;
    text-align:center;
    padding:40px 20px;
}

header h1 {
    margin:0;
    font-size:32px;
}

header p {
    margin-top:8px;
    opacity:0.9;
}

.container {
    max-width:1100px;
    margin:30px auto;
    padding:0 20px;
}

.filters {
    display:flex;
    flex-wrap:wrap;
    gap:10px;
    margin-bottom:20px;
    justify-content:center;
}

.filters select, .filters input[type=range] {
    padding:5px 10px;
    border-radius:6px;
    border:1px solid #ccc;
}

.filters span {
    min-width:100px;
    text-align:center;
}

.grid {
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
    gap:20px;
}

.card {
    background:white;
    border-radius:12px;
    box-shadow:0 10px 25px rgba(0,0,0,0.08);
    overflow:hidden;
    transition:0.3s;
    cursor:pointer;
    text-align:center;
}

.card:hover {
    transform:translateY(-5px);
    box-shadow:0 15px 30px rgba(0,0,0,0.15);
}

.card h3 {
    margin:10px 0 5px;
}

.price {
    font-weight:bold;
    font-size:18px;
    margin:5px 0;
}

.stock {
    font-weight:bold;
}

.stock.in { color:green; }
.stock.out { color:red; }

.product-view {
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.7);
    display:none;
    align-items:center;
    justify-content:center;
    padding:20px;
    z-index:999;
}

.product-box {
    background:white;
    max-width:500px;
    width:100%;
    border-radius:12px;
    padding:20px;
    text-align:center;
    overflow-y:auto;
    max-height:90vh;
}

.product-box img {
    max-width:100%;
    margin-bottom:10px;
    border-radius:10px;
}

.btn {
    display:inline-block;
    margin-top:15px;
    padding:10px 15px;
    background:#22c55e;
    color:white;
    text-decoration:none;
    border-radius:8px;
    font-weight:bold;
}

.close {
    margin-top:15px;
    display:block;
    cursor:pointer;
    color:#555;
}
</style>
</head>
<body>

<header>
    <h1>Mundo Smart TV</h1>
    <p>Televisores modernos de diferentes marcas</p>
</header>

<div class="container filters">
    <select id="marcaFilter">
        <option value="">Todas las marcas</option>
    </select>
    <select id="tamanoFilter">
        <option value="">Todos los tamaños</option>
    </select>
    <input type="range" id="precioMin" min="0" max="100000" value="0">
    <input type="range" id="precioMax" min="0" max="100000" value="100000">
    <span id="precioDisplay">0 - 100,000</span>
</div>

<div class="container">
    <div id="productos" class="grid"></div>
</div>

<div id="productView" class="product-view">
    <div class="product-box" id="productBox"></div>
</div>

<script>
// URL de SheetJSON
const JSON_URL = "https://sheetjson.com/spreadsheets/d/1-XvTphECWH1qlJvIzMAHrhRYyFURMDoF?gid=0";
let productosGlobal = [];

async function fetchData(){
    try {
        const res = await fetch(JSON_URL);
        const data = await res.json();
        productosGlobal = data.map(p => ({
            marca: p.marca || p.Marca || "",
            modelo: p.modelo || p.Modelo || "",
            tamaño: p.tamano || p.Tamano || "",
            precio: parseFloat(p.precio || p.Precio || "0"),
            stock: parseInt(p.stock || p.Stock || "0")
        }));
        render(productosGlobal);
        populateFilters(productosGlobal);
    } catch(err){
        console.error("Error cargando el catálogo:", err);
    }
}

function render(products){
    const container = document.getElementById("productos");
    container.innerHTML = products.map(p=>{
        const stockClass = p.stock > 0 ? "in" : "out";
        const stockText = p.stock > 0 ? "Disponible" : "Agotado";
        return `
        <div class="card" onclick="openProduct('${p.marca}','${p.modelo}','${p.tamaño}','${p.precio}')">
            <h3>${p.marca} ${p.modelo}</h3>
            <div class="price">$${p.precio.toLocaleString('es-MX')}</div>
            <div class="stock ${stockClass}">${stockText}</div>
        </div>`;
    }).join("");
}

function populateFilters(products){
    const marcas = [...new Set(products.map(p=>p.marca))];
    const tamanos = [...new Set(products.map(p=>p.tamaño))];

    const marcaSelect = document.getElementById("marcaFilter");
    const tamanoSelect = document.getElementById("tamanoFilter");

    marcas.forEach(m => {
        const opt = document.createElement("option"); opt.value=m; opt.text=m;
        marcaSelect.add(opt);
    });

    tamanos.forEach(t => {
        const opt = document.createElement("option"); opt.value=t; opt.text=t;
        tamanoSelect.add(opt);
    });

    marcaSelect.addEventListener("change", applyFilters);
    tamanoSelect.addEventListener("change", applyFilters);
    document.getElementById("precioMin").addEventListener("input", applyFilters);
    document.getElementById("precioMax").addEventListener("input", applyFilters);
}

function applyFilters(){
    const marca = document.getElementById("marcaFilter").value;
    const tamano = document.getElementById("tamanoFilter").value;
    const min = parseFloat(document.getElementById("precioMin").value);
    const max = parseFloat(document.getElementById("precioMax").value);
    document.getElementById("precioDisplay").innerText = `${min.toLocaleString()} - ${max.toLocaleString()}`;

    const filtrados = productosGlobal.filter(p=>{
        return (!marca || p.marca === marca) &&
               (!tamano || p.tamaño === tamano) &&
               (p.precio >= min && p.precio <= max);
    });
    render(filtrados);
}

function openProduct(marca, modelo, tamaño, precio){
    const box = document.getElementById("productBox");
    const tvImg = `imagenes/tv-${tamaño}.png`;
    const logoImg = `imagenes/${marca.toLowerCase()}.png`;
    box.innerHTML = `
        <img src="${tvImg}" alt="TV ${modelo}">
        <img src="${logoImg}" alt="${marca}" style="height:40px; margin-bottom:10px;">
        <h2>${marca} ${modelo}</h2>
        <p>${marca} ${tamaño}" Smart TV con excelente calidad de imagen y conectividad HDMI, USB y WiFi.</p>
        <div class="price">$${Number(precio).toLocaleString('es-MX')}</div>
        <a class="btn" href="https://wa.me/1234567890?text=Hola quiero pedir la ${marca} ${modelo} de ${tamaño} pulgadas" target="_blank">Contactar y hacer pedido</a>
        <span class="close" onclick="closeProduct()">Cerrar</span>
    `;
    document.getElementById("productView").style.display="flex";
}

function closeProduct(){
    document.getElementById("productView").style.display="none";
}

// Carga inicial
fetchData();
</script>

</body>
</html>
