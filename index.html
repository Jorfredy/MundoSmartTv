<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mundo Smart TV</title>
<style>
/* ===== Estilos globales ===== */
body {
    margin:0; /* Quita el margen por defecto */
    font-family: Arial, Helvetica, sans-serif; /* Fuente principal */
    background:#f5f7fa; /* Color de fondo */
    color:#111; /* Color de texto */
}

/* Header de la página */
header {
    background:#0f172a; /* Color de fondo del header */
    color:white; /* Color del texto */
    text-align:center; /* Centrar contenido */
    padding:30px 20px; /* Espaciado interno */
}
header h1 { margin:0; font-size:28px; } /* Título principal */
header p { margin-top:5px; opacity:0.9; } /* Subtítulo con opacidad */

/* Contenedor principal para centrar y limitar ancho */
.container { max-width:1100px; margin:20px auto; padding:0 20px; }

/* ===== Barra de búsqueda y botón de filtros ===== */
.controls {
    display:flex; /* Flexbox para alinear elementos */
    flex-wrap:wrap; /* Permite que se envuelvan en pantallas pequeñas */
    gap:10px; /* Espacio entre elementos */
    justify-content: space-between;
    margin-bottom:20px;
}
#searchInput {
    flex:1; /* Ocupa todo el espacio disponible */
    padding:8px 10px; /* Relleno interno */
    border-radius:6px; /* Bordes redondeados */
    border:1px solid #ccc; /* Borde gris */
}
#filterBtn {
    padding:8px 15px;
    border:none;
    background:#0f172a; /* Color del botón */
    color:white;
    border-radius:6px;
    cursor:pointer;
}

/* ===== Filtros desplegables ===== */
.filters {
    display:none; /* Inicialmente ocultos */
    flex-wrap:wrap; 
    gap:10px;
    margin-bottom:20px;
}
.filters select {
    padding:6px 10px;
    border-radius:6px;
    border:1px solid #ccc;
}

/* ===== Grid de productos ===== */
.grid {
    display:grid;
    grid-template-columns: repeat(2, 1fr); /* 2 columnas */
    gap:20px;
}
.card {
    background:white;
    border-radius:12px; /* Bordes redondeados */
    box-shadow:0 8px 20px rgba(0,0,0,0.08); /* Sombra suave */
    overflow:hidden;
    transition:0.3s;
    cursor:pointer;
    text-align:center;
    padding:10px;
}
.card:hover {
    transform:translateY(-5px); /* Levanta tarjeta al pasar mouse */
    box-shadow:0 12px 25px rgba(0,0,0,0.15);
}
.card img { width:100%; height:150px; object-fit:cover; border-radius:10px; } /* Imagen del producto */
.card .marca { font-size:20px; font-weight:bold; margin:8px 0 2px; } /* Marca de TV */
.card .modelo { font-size:14px; color:#555; margin-bottom:5px; } /* Modelo */
.card .price { font-weight:bold; font-size:16px; margin:5px 0; } /* Precio */
.card .stock.in { color:green; font-weight:bold; } /* Stock disponible */
.card .stock.out { color:red; font-weight:bold; } /* Stock agotado */

/* ===== Modal de producto ===== */
.product-view {
    position:fixed; top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.7); /* Fondo semi-transparente */
    display:none; /* Oculto hasta abrir */
    align-items:center; justify-content:center;
    padding:20px; z-index:999;
}
.product-box {
    background:white;
    max-width:400px; width:100%; border-radius:12px;
    padding:20px; text-align:center;
    overflow-y:auto; max-height:90vh;
}
.product-box img { max-width:100%; margin-bottom:10px; border-radius:10px; }
.btn {
    display:inline-block; margin-top:15px;
    padding:10px 15px; background:#22c55e; color:white;
    text-decoration:none; border-radius:8px; font-weight:bold;
}
.close { margin-top:15px; display:block; cursor:pointer; color:#555; }

/* ===== Paginación ===== */
.pagination { display:flex; justify-content:center; gap:15px; margin-top:20px; }
.page-btn {
    padding:8px 16px; border:none; border-radius:6px;
    cursor:pointer; background:#0f172a; color:white; font-weight:bold;
}
.page-btn:disabled { background:#ccc; cursor:not-allowed; }

/* ===== Footer ===== */
footer {
    text-align:center; margin:30px 0 10px;
    position: relative; color:white; font-size:14px;
    background:#0f172a; padding:10px 0;
}
footer::before {
    content:"";
    position:absolute; top:0; left:0;
    width:100%; height:100%; background:#0f172a;
    transform:skewY(-3deg); z-index:-1;
}

/* ===== Responsive ===== */
@media(max-width:600px){
    .grid { grid-template-columns:1fr; } /* Una columna en móviles */
}
</style>
</head>
<body>

<header>
    <h1>Mundo Smart TV</h1>
    <p>Encuentra tu TV perfecta</p>
</header>

<!-- Barra de búsqueda y botón de filtros -->
<div class="container controls">
    <input type="text" id="searchInput" placeholder="Buscar por marca o modelo...">
    <button id="filterBtn">Filtros</button>
</div>

<!-- Filtros desplegables -->
<div class="container filters" id="filterSection">
    <select id="marcaFilter"><option value="">Todas las marcas</option></select>
    <select id="tamanoFilter"><option value="">Todos los tamaños</option></select>
    <select id="ordenPrecio">
        <option value="">Ordenar por precio</option>
        <option value="desc">Mayor a menor</option>
        <option value="asc">Menor a mayor</option>
    </select>
    <select id="ordenTamano">
        <option value="">Ordenar por tamaño</option>
        <option value="asc">Menor a mayor</option>
        <option value="desc">Mayor a menor</option>
    </select>
</div>

<!-- Grid de productos y paginación -->
<div class="container">
    <div id="productos" class="grid"></div>
    <div class="pagination">
        <button class="page-btn" id="prevBtn">Anterior</button>
        <button class="page-btn" id="nextBtn">Siguiente</button>
    </div>
</div>

<!-- Modal de producto -->
<div id="productView" class="product-view">
    <div class="product-box" id="productBox"></div>
</div>

<footer>
    &copy; 2026 Mundo Smart TV. Todos los derechos reservados.
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {

    const JSON_URL = "https://sheetjson.com/spreadsheets/d/1-XvTphECWH1qlJvIzMAHrhRYyFURMDoF?gid=0";

    let productosGlobal = []; // Array con todos los productos
    let currentPage = 1; // Página actual
    const itemsPerPage = 8; // Productos por página

    // ===== Traer productos desde Google Sheets =====
    async function fetchData(){
        const res = await fetch(JSON_URL);
        const data = await res.json();
        // Mapear datos a formato consistente
        productosGlobal = data.map(p => ({
            marca: p.marca || p.Marca || "",
            modelo: p.modelo || p.Modelo || "",
            tamaño: p.tamano || p.Tamano || "",
            precio: parseFloat(p.precio || p.Precio || "0"),
            stock: parseInt(p.stock || p.Stock || "0"),
            descripciones: p.descripciones || ""
        }));
        populateFilters(productosGlobal); // Llenar filtros
        renderPage(); // Renderizar la primera página
    }

    // ===== Llenado de filtros y eventos =====
    function populateFilters(products){
        const marcas = [...new Set(products.map(p=>p.marca))]; // Marcas únicas
        const tamanos = [...new Set(products.map(p=>p.tamaño))]; // Tamaños únicos

        const marcaSelect = document.getElementById("marcaFilter");
        const tamanoSelect = document.getElementById("tamanoFilter");

        // Evitar errores si no existen los elementos
        if(!marcaSelect || !tamanoSelect) return;

        marcas.forEach(m => { const opt=document.createElement("option"); opt.value=m; opt.text=m; marcaSelect.add(opt); });
        tamanos.forEach(t => { const opt=document.createElement("option"); opt.value=t; opt.text=t; tamanoSelect.add(opt); });

        // Eventos de cambio para filtros y búsqueda
        marcaSelect.addEventListener("change",()=>{currentPage=1; renderPage();});
        tamanoSelect.addEventListener("change",()=>{currentPage=1; renderPage();});
        document.getElementById("ordenPrecio").addEventListener("change",()=>{currentPage=1; renderPage();});
        document.getElementById("ordenTamano").addEventListener("change",()=>{currentPage=1; renderPage();});
        document.getElementById("searchInput").addEventListener("input",()=>{currentPage=1; renderPage();});
        document.getElementById("filterBtn").addEventListener("click", ()=>{
            const f = document.getElementById("filterSection");
            f.style.display = f.style.display==="flex"?"none":"flex";
        });
    }

    // ===== Descripción aleatoria de producto =====
    function getRandomDescription(descripciones){
        if(!descripciones) return "Smart TV de alta calidad";
        let arr = Array.isArray(descripciones) ? descripciones : descripciones.split("|");
        return arr[Math.floor(Math.random()*arr.length)];
    }

    // ===== Aplicar filtros y búsqueda =====
    function applyFilters(){
        let filtered = [...productosGlobal];
        const marca = document.getElementById("marcaFilter").value.toLowerCase();
        const tamano = document.getElementById("tamanoFilter").value;
        const search = document.getElementById("searchInput").value.toLowerCase();

        filtered = filtered.filter(p=>{
            return (!marca || p.marca.toLowerCase()===marca) &&
                   (!tamano || p.tamaño===tamano) &&
                   (p.marca.toLowerCase().includes(search) || p.modelo.toLowerCase().includes(search));
        });

        // Ordenar por precio
        const precioOrden = document.getElementById("ordenPrecio").value;
        if(precioOrden==="asc") filtered.sort((a,b)=>a.precio-b.precio);
        if(precioOrden==="desc") filtered.sort((a,b)=>b.precio-a.precio);

        // Ordenar por tamaño
        const tamanoOrden = document.getElementById("ordenTamano").value;
        if(tamanoOrden==="asc") filtered.sort((a,b)=>parseInt(a.tamaño)-parseInt(b.tamaño));
        if(tamanoOrden==="desc") filtered.sort((a,b)=>parseInt(b.tamaño)-parseInt(a.tamaño));

        return filtered;
    }

    // ===== Renderizar productos en el grid =====
    function render(products){
        const container = document.getElementById("productos");
        container.innerHTML = products.map(p=>{
            const stockClass = p.stock>0?"in":"out"; // Clase para stock
            const stockText = p.stock>0?"Disponible":"Agotado";
            const tvImg = `imagenes/tv-${p.tamaño}.png`;
            return `
            <div class="card" onclick="openProduct('${p.marca}','${p.modelo}','${p.tamaño}','${p.precio}','${p.descripciones}')">
                <img src="${tvImg}" alt="${p.modelo}">
                <div class="marca">${p.marca}</div>
                <div class="modelo">${p.modelo}</div>
                <div class="price">$${p.precio.toLocaleString('es-MX')}</div>
                <div class="stock ${stockClass}">${stockText}</div>
            </div>`;
        }).join("");
    }

    // ===== Renderizar página con paginación =====
    function renderPage(){
        const filtered = applyFilters();
        const totalPages = Math.ceil(filtered.length/itemsPerPage);
        if(currentPage>totalPages) currentPage = totalPages || 1;
        const start = (currentPage-1)*itemsPerPage;
        const end = start+itemsPerPage;
        render(filtered.slice(start,end));

        document.getElementById("prevBtn").disabled = currentPage===1;
        document.getElementById("nextBtn").disabled = currentPage===totalPages || totalPages===0;
    }

    // ===== Botones de paginación =====
    document.getElementById("prevBtn").addEventListener("click",()=>{
        if(currentPage>1){ currentPage--; renderPage(); }
    });
    document.getElementById("nextBtn").addEventListener("click",()=>{
        const filtered = applyFilters();
        const totalPages = Math.ceil(filtered.length/itemsPerPage);
        if(currentPage<totalPages){ currentPage++; renderPage(); }
    });

    // ===== Modal de producto =====
    function openProduct(marca, modelo, tamaño, precio, descripciones){
        const box = document.getElementById("productBox");
        const tvImg = `imagenes/tv-${tamaño}.png`;
        const desc = getRandomDescription(descripciones);
        box.innerHTML = `
            <img src="${tvImg}" alt="TV ${modelo}">
            <h2>${marca} ${modelo}</h2>
            <p>${desc}</p>
            <div class="price">$${Number(precio).toLocaleString('es-MX')}</div>
            <a class="btn" href="https://wa.me/1234567890?text=Hola quiero pedir la ${marca} ${modelo} de ${tamaño} pulgadas" target="_blank">Contactar y hacer pedido</a>
            <span class="close" onclick="closeProduct()">Cerrar</span>
        `;
        document.getElementById("productView").style.display="flex";
    }

    function closeProduct(){ document.getElementById("productView").style.display="none"; }

    // ===== Inicializar =====
    fetchData();

});
</script>
</body>
</html>
